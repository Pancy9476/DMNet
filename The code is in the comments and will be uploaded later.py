The code is in the comments and will be uploaded later.